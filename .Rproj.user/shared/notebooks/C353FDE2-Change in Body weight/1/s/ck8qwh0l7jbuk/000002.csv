"0","#for the prediction intervals"
"0","out.jagsNMA.results3<-function (JAGSobject, parameter = parameter, forestplot = F, "
"0","                                treatnames = NA, rounding = 2) "
"0","{"
"0","resultstable = JAGSobject$BUGSoutput$summary"
"0","allvariablenames = rownames(resultstable)"
"0","rowsmatching = substr(allvariablenames, 1, nchar(parameter))"
"0","rowstokeep = startsWith(rowsmatching, parameter)"
"0","resultstabletokeep = resultstable[rowstokeep, c(3, 7)]"
"0","rowstokeep2 = startsWith(dimnames(resultstabletokeep)[[1]], "
"0","                         paste(parameter, ""["", sep = """"))"
"0","resultstabletokeep = resultstabletokeep[rowstokeep2, ]"
"0","library(stringr)"
"0","tosplit = unlist(strsplit(rownames(resultstabletokeep), "",""))"
"0","tosplit2 <- as.numeric(str_extract(tosplit, ""[0-9]+""))"
"0","nroftreatments = max(tosplit2)"
"0","location = matrix(tosplit2, ncol = 2, byrow = T)"
"0","CImatl= CImatu = matrix(NA, nrow = nroftreatments, "
"0","                                          ncol = nroftreatments)"
"0","for (i in 1:nrow(location)) {"
"0","  "
"0","  CImatl[location[i, 1], location[i, 2]] = resultstabletokeep[i, "
"0","                                                              1]"
"0","  CImatu[location[i, 1], location[i, 2]] = resultstabletokeep[i, "
"0","                                                              2]"
"0","}"
"0","CImatl = round(CImatl, rounding)"
"0","CImatu = round(CImatu, rounding)"
"0","Ttreat = dim(CImatl)[1]"
"0","toprintmat = matrix(nrow = Ttreat, ncol = Ttreat)"
"0","for (i in 1:Ttreat ) {"
"0","  for (j in 1:Ttreat) {"
"0","    toprintmat[j, i] = paste(""("", "
"0","                             CImatl[j,i], "", "", CImatu[j, i], "")"")"
"0","  }"
"0","}"
"0","if (!missing(treatnames)) {"
"0","  diag(CImatl) = treatnames"
"0","  diag(CImatu) = treatnames"
"0","  diag(toprintmat) = treatnames"
"0","}"
"0","list(CIl = CImatl, CIu = CImatu, ORpred = toprintmat)"
"0","}"
